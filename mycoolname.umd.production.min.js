!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("three"),require("react")):"function"==typeof define&&define.amd?define(["exports","three","react"],t):t((e=e||self).TsdxThreejsTemplate={},e.THREE,e.React)}(this,(function(e,t,n){"use strict";function o(e,t,n,o,r,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(o,r)}function r(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function s(e){o(a,r,i,s,c,"next",e)}function c(e){o(a,r,i,s,c,"throw",e)}s(void 0)}))}}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function a(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n;var s=function(e,t){return function(e){var t=function(e){var t=Object.prototype,n=t.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},r=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",a=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,o){var r=Object.create((t&&t.prototype instanceof l?t:l).prototype),i=new L(o||[]);return r._invoke=function(e,t,n){var o="suspendedStart";return function(r,i){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===r)throw i;return{value:void 0,done:!0}}for(n.method=r,n.arg=i;;){var a=n.delegate;if(a){var s=_(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var c=u(e,t,n);if("normal"===c.type){if(o=n.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o="completed",n.method="throw",n.arg=c.arg)}}}(e,n,i),r}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var h={};function l(){}function p(){}function d(){}var m={};m[r]=function(){return this};var f=Object.getPrototypeOf,g=f&&f(f(x([])));g&&g!==t&&n.call(g,r)&&(m=g);var y=d.prototype=l.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function v(e,t){var o;this._invoke=function(r,i){function a(){return new t((function(o,a){!function o(r,i,a,s){var c=u(e[r],e,i);if("throw"!==c.type){var h=c.arg,l=h.value;return l&&"object"==typeof l&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){o("next",e,a,s)}),(function(e){o("throw",e,a,s)})):t.resolve(l).then((function(e){h.value=e,a(h)}),(function(e){return o("throw",e,a,s)}))}s(c.arg)}(r,i,o,a)}))}return o=o?o.then(a,a):a()}}function _(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var o=u(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,h;var r=o.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function x(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:j}}function j(){return{value:void 0,done:!0}}return p.prototype=y.constructor=d,d.constructor=p,p.displayName=s(d,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,s(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},b(v.prototype),v.prototype[i]=function(){return this},e.AsyncIterator=v,e.async=function(t,n,o,r,i){void 0===i&&(i=Promise);var a=new v(c(t,n,o,r),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(y),s(y,a,"Generator"),y[r]=function(){return this},y.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var o=t.pop();if(o in e)return n.value=o,n.done=!1,n}return n.done=!0,n}},e.values=x,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return a.type="throw",a.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var r=this.tryEntries[o];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var r=o.arg;E(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:x(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}(t={exports:{}}),t.exports}();const c={type:"change"},u={type:"start"},h={type:"end"};class l extends t.EventDispatcher{constructor(e,n){super(),void 0===n&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),n===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=n,this.enabled=!0,this.target=new t.Vector3,this.minDistance=0,this.maxDistance=Infinity,this.minZoom=0,this.maxZoom=Infinity,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-Infinity,this.maxAzimuthAngle=Infinity,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:t.MOUSE.ROTATE,MIDDLE:t.MOUSE.DOLLY,RIGHT:t.MOUSE.PAN},this.touches={ONE:t.TOUCH.ROTATE,TWO:t.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return s.phi},this.getAzimuthalAngle=function(){return s.theta},this.listenToKeyEvents=function(e){e.addEventListener("keydown",U),this._domElementKeyEvents=e},this.saveState=function(){o.target0.copy(o.target),o.position0.copy(o.object.position),o.zoom0=o.object.zoom},this.reset=function(){o.target.copy(o.target0),o.object.position.copy(o.position0),o.object.zoom=o.zoom0,o.object.updateProjectionMatrix(),o.dispatchEvent(c),o.update(),i=r.NONE},this.update=function(){const n=new t.Vector3,u=(new t.Quaternion).setFromUnitVectors(e.up,new t.Vector3(0,1,0)),h=u.clone().invert(),f=new t.Vector3,g=new t.Quaternion,y=2*Math.PI;return function(){const e=o.object.position;n.copy(e).sub(o.target),n.applyQuaternion(u),s.setFromVector3(n),o.autoRotate&&i===r.NONE&&j(2*Math.PI/60/60*o.autoRotateSpeed),o.enableDamping?(s.theta+=l.theta*o.dampingFactor,s.phi+=l.phi*o.dampingFactor):(s.theta+=l.theta,s.phi+=l.phi);let t=o.minAzimuthAngle,b=o.maxAzimuthAngle;return isFinite(t)&&isFinite(b)&&(t<-Math.PI?t+=y:t>Math.PI&&(t-=y),b<-Math.PI?b+=y:b>Math.PI&&(b-=y),s.theta=t<=b?Math.max(t,Math.min(b,s.theta)):s.theta>(t+b)/2?Math.max(t,s.theta):Math.min(b,s.theta)),s.phi=Math.max(o.minPolarAngle,Math.min(o.maxPolarAngle,s.phi)),s.makeSafe(),s.radius*=p,s.radius=Math.max(o.minDistance,Math.min(o.maxDistance,s.radius)),!0===o.enableDamping?o.target.addScaledVector(d,o.dampingFactor):o.target.add(d),n.setFromSpherical(s),n.applyQuaternion(h),e.copy(o.target).add(n),o.object.lookAt(o.target),!0===o.enableDamping?(l.theta*=1-o.dampingFactor,l.phi*=1-o.dampingFactor,d.multiplyScalar(1-o.dampingFactor)):(l.set(0,0,0),d.set(0,0,0)),p=1,!!(m||f.distanceToSquared(o.object.position)>a||8*(1-g.dot(o.object.quaternion))>a)&&(o.dispatchEvent(c),f.copy(o.object.position),g.copy(o.object.quaternion),m=!1,!0)}}(),this.dispose=function(){o.domElement.removeEventListener("contextmenu",q),o.domElement.removeEventListener("pointerdown",N),o.domElement.removeEventListener("wheel",G),o.domElement.removeEventListener("touchstart",X),o.domElement.removeEventListener("touchend",Z),o.domElement.removeEventListener("touchmove",B),o.domElement.ownerDocument.removeEventListener("pointermove",z),o.domElement.ownerDocument.removeEventListener("pointerup",Y),null!==o._domElementKeyEvents&&o._domElementKeyEvents.removeEventListener("keydown",U)};const o=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let i=r.NONE;const a=1e-6,s=new t.Spherical,l=new t.Spherical;let p=1;const d=new t.Vector3;let m=!1;const f=new t.Vector2,g=new t.Vector2,y=new t.Vector2,b=new t.Vector2,v=new t.Vector2,_=new t.Vector2,w=new t.Vector2,E=new t.Vector2,L=new t.Vector2;function x(){return Math.pow(.95,o.zoomSpeed)}function j(e){l.theta-=e}function k(e){l.phi-=e}const O=function(){const e=new t.Vector3;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),d.add(e)}}(),C=function(){const e=new t.Vector3;return function(t,n){!0===o.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(o.object.up,e)),e.multiplyScalar(t),d.add(e)}}(),T=function(){const e=new t.Vector3;return function(t,n){const r=o.domElement;if(o.object.isPerspectiveCamera){e.copy(o.object.position).sub(o.target);let i=e.length();i*=Math.tan(o.object.fov/2*Math.PI/180),O(2*t*i/r.clientHeight,o.object.matrix),C(2*n*i/r.clientHeight,o.object.matrix)}else o.object.isOrthographicCamera?(O(t*(o.object.right-o.object.left)/o.object.zoom/r.clientWidth,o.object.matrix),C(n*(o.object.top-o.object.bottom)/o.object.zoom/r.clientHeight,o.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),o.enablePan=!1)}}();function A(e){o.object.isPerspectiveCamera?p/=e:o.object.isOrthographicCamera?(o.object.zoom=Math.max(o.minZoom,Math.min(o.maxZoom,o.object.zoom*e)),o.object.updateProjectionMatrix(),m=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),o.enableZoom=!1)}function M(e){o.object.isPerspectiveCamera?p*=e:o.object.isOrthographicCamera?(o.object.zoom=Math.max(o.minZoom,Math.min(o.maxZoom,o.object.zoom/e)),o.object.updateProjectionMatrix(),m=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),o.enableZoom=!1)}function P(e){f.set(e.clientX,e.clientY)}function D(e){b.set(e.clientX,e.clientY)}function V(e){1==e.touches.length?f.set(e.touches[0].pageX,e.touches[0].pageY):f.set(.5*(e.touches[0].pageX+e.touches[1].pageX),.5*(e.touches[0].pageY+e.touches[1].pageY))}function S(e){1==e.touches.length?b.set(e.touches[0].pageX,e.touches[0].pageY):b.set(.5*(e.touches[0].pageX+e.touches[1].pageX),.5*(e.touches[0].pageY+e.touches[1].pageY))}function R(e){const t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,o=Math.sqrt(t*t+n*n);w.set(0,o)}function I(e){1==e.touches.length?g.set(e.touches[0].pageX,e.touches[0].pageY):g.set(.5*(e.touches[0].pageX+e.touches[1].pageX),.5*(e.touches[0].pageY+e.touches[1].pageY)),y.subVectors(g,f).multiplyScalar(o.rotateSpeed);const t=o.domElement;j(2*Math.PI*y.x/t.clientHeight),k(2*Math.PI*y.y/t.clientHeight),f.copy(g)}function F(e){1==e.touches.length?v.set(e.touches[0].pageX,e.touches[0].pageY):v.set(.5*(e.touches[0].pageX+e.touches[1].pageX),.5*(e.touches[0].pageY+e.touches[1].pageY)),_.subVectors(v,b).multiplyScalar(o.panSpeed),T(_.x,_.y),b.copy(v)}function H(e){const t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);E.set(0,r),L.set(0,Math.pow(E.y/w.y,o.zoomSpeed)),A(L.y),w.copy(E)}function N(e){if(!1!==o.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){let n;switch(e.preventDefault(),o.domElement.focus?o.domElement.focus():window.focus(),e.button){case 0:n=o.mouseButtons.LEFT;break;case 1:n=o.mouseButtons.MIDDLE;break;case 2:n=o.mouseButtons.RIGHT;break;default:n=-1}switch(n){case t.MOUSE.DOLLY:if(!1===o.enableZoom)return;!function(e){w.set(e.clientX,e.clientY)}(e),i=r.DOLLY;break;case t.MOUSE.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===o.enablePan)return;D(e),i=r.PAN}else{if(!1===o.enableRotate)return;P(e),i=r.ROTATE}break;case t.MOUSE.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===o.enableRotate)return;P(e),i=r.ROTATE}else{if(!1===o.enablePan)return;D(e),i=r.PAN}break;default:i=r.NONE}i!==r.NONE&&(o.domElement.ownerDocument.addEventListener("pointermove",z),o.domElement.ownerDocument.addEventListener("pointerup",Y),o.dispatchEvent(u))}(e)}}function z(e){if(!1!==o.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){if(!1!==o.enabled)switch(e.preventDefault(),i){case r.ROTATE:if(!1===o.enableRotate)return;!function(e){g.set(e.clientX,e.clientY),y.subVectors(g,f).multiplyScalar(o.rotateSpeed);const t=o.domElement;j(2*Math.PI*y.x/t.clientHeight),k(2*Math.PI*y.y/t.clientHeight),f.copy(g),o.update()}(e);break;case r.DOLLY:if(!1===o.enableZoom)return;!function(e){E.set(e.clientX,e.clientY),L.subVectors(E,w),L.y>0?A(x()):L.y<0&&M(x()),w.copy(E),o.update()}(e);break;case r.PAN:if(!1===o.enablePan)return;!function(e){v.set(e.clientX,e.clientY),_.subVectors(v,b).multiplyScalar(o.panSpeed),T(_.x,_.y),b.copy(v),o.update()}(e)}}(e)}}function Y(e){switch(e.pointerType){case"mouse":case"pen":o.domElement.ownerDocument.removeEventListener("pointermove",z),o.domElement.ownerDocument.removeEventListener("pointerup",Y),!1!==o.enabled&&(o.dispatchEvent(h),i=r.NONE)}}function G(e){!1===o.enabled||!1===o.enableZoom||i!==r.NONE&&i!==r.ROTATE||(e.preventDefault(),o.dispatchEvent(u),function(e){e.deltaY<0?M(x()):e.deltaY>0&&A(x()),o.update()}(e),o.dispatchEvent(h))}function U(e){!1!==o.enabled&&!1!==o.enablePan&&function(e){let t=!1;switch(e.code){case o.keys.UP:T(0,o.keyPanSpeed),t=!0;break;case o.keys.BOTTOM:T(0,-o.keyPanSpeed),t=!0;break;case o.keys.LEFT:T(o.keyPanSpeed,0),t=!0;break;case o.keys.RIGHT:T(-o.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),o.update())}(e)}function X(e){if(!1!==o.enabled){switch(e.preventDefault(),e.touches.length){case 1:switch(o.touches.ONE){case t.TOUCH.ROTATE:if(!1===o.enableRotate)return;V(e),i=r.TOUCH_ROTATE;break;case t.TOUCH.PAN:if(!1===o.enablePan)return;S(e),i=r.TOUCH_PAN;break;default:i=r.NONE}break;case 2:switch(o.touches.TWO){case t.TOUCH.DOLLY_PAN:if(!1===o.enableZoom&&!1===o.enablePan)return;!function(e){o.enableZoom&&R(e),o.enablePan&&S(e)}(e),i=r.TOUCH_DOLLY_PAN;break;case t.TOUCH.DOLLY_ROTATE:if(!1===o.enableZoom&&!1===o.enableRotate)return;!function(e){o.enableZoom&&R(e),o.enableRotate&&V(e)}(e),i=r.TOUCH_DOLLY_ROTATE;break;default:i=r.NONE}break;default:i=r.NONE}i!==r.NONE&&o.dispatchEvent(u)}}function B(e){if(!1!==o.enabled)switch(e.preventDefault(),i){case r.TOUCH_ROTATE:if(!1===o.enableRotate)return;I(e),o.update();break;case r.TOUCH_PAN:if(!1===o.enablePan)return;F(e),o.update();break;case r.TOUCH_DOLLY_PAN:if(!1===o.enableZoom&&!1===o.enablePan)return;!function(e){o.enableZoom&&H(e),o.enablePan&&F(e)}(e),o.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===o.enableZoom&&!1===o.enableRotate)return;!function(e){o.enableZoom&&H(e),o.enableRotate&&I(e)}(e),o.update();break;default:i=r.NONE}}function Z(e){!1!==o.enabled&&(o.dispatchEvent(h),i=r.NONE)}function q(e){!1!==o.enabled&&e.preventDefault()}o.domElement.addEventListener("contextmenu",q),o.domElement.addEventListener("pointerdown",N),o.domElement.addEventListener("wheel",G,{passive:!1}),o.domElement.addEventListener("touchstart",X,{passive:!1}),o.domElement.addEventListener("touchend",Z),o.domElement.addEventListener("touchmove",B,{passive:!1}),this.update()}}const p={type:"change"},d={type:"start"},m={type:"end"};class f extends t.EventDispatcher{constructor(e,n){super(),void 0===n&&console.warn('THREE.TrackballControls: The second parameter "domElement" is now mandatory.'),n===document&&console.error('THREE.TrackballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.');const o=this;this.object=e,this.domElement=n,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=Infinity,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:t.MOUSE.ROTATE,MIDDLE:t.MOUSE.DOLLY,RIGHT:t.MOUSE.PAN},this.target=new t.Vector3;const r=new t.Vector3;let i=1,a=-1,s=-1,c=0,u=0,h=0;const l=new t.Vector3,f=new t.Vector2,g=new t.Vector2,y=new t.Vector3,b=new t.Vector2,v=new t.Vector2,_=new t.Vector2,w=new t.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,this.handleResize=function(){const e=o.domElement.getBoundingClientRect(),t=o.domElement.ownerDocument.documentElement;o.screen.left=e.left+window.pageXOffset-t.clientLeft,o.screen.top=e.top+window.pageYOffset-t.clientTop,o.screen.width=e.width,o.screen.height=e.height};const E=function(){const e=new t.Vector2;return function(t,n){return e.set((t-o.screen.left)/o.screen.width,(n-o.screen.top)/o.screen.height),e}}(),L=function(){const e=new t.Vector2;return function(t,n){return e.set((t-.5*o.screen.width-o.screen.left)/(.5*o.screen.width),(o.screen.height+2*(o.screen.top-n))/o.screen.width),e}}();function x(e){if(!1!==o.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){if(e.preventDefault(),-1===a)switch(e.button){case o.mouseButtons.LEFT:a=0;break;case o.mouseButtons.MIDDLE:a=1;break;case o.mouseButtons.RIGHT:a=2;break;default:a=-1}const t=-1!==s?s:a;0!==t||o.noRotate?1!==t||o.noZoom?2!==t||o.noPan||(_.copy(E(e.pageX,e.pageY)),w.copy(_)):(b.copy(E(e.pageX,e.pageY)),v.copy(b)):(g.copy(L(e.pageX,e.pageY)),f.copy(g)),o.domElement.ownerDocument.addEventListener("pointermove",j),o.domElement.ownerDocument.addEventListener("pointerup",k),o.dispatchEvent(d)}(e)}}function j(e){if(!1!==o.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){if(!1===o.enabled)return;e.preventDefault();const t=-1!==s?s:a;0!==t||o.noRotate?1!==t||o.noZoom?2!==t||o.noPan||w.copy(E(e.pageX,e.pageY)):v.copy(E(e.pageX,e.pageY)):(f.copy(g),g.copy(L(e.pageX,e.pageY)))}(e)}}function k(e){if(!1!==o.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){!1!==o.enabled&&(e.preventDefault(),a=-1,o.domElement.ownerDocument.removeEventListener("pointermove",j),o.domElement.ownerDocument.removeEventListener("pointerup",k),o.dispatchEvent(m))}(e)}}function O(e){!1!==o.enabled&&(window.removeEventListener("keydown",O),-1===s&&(e.code!==o.keys[0]||o.noRotate?e.code!==o.keys[1]||o.noZoom?e.code!==o.keys[2]||o.noPan||(s=2):s=1:s=0))}function C(){!1!==o.enabled&&(s=-1,window.addEventListener("keydown",O))}function T(e){if(!1!==o.enabled&&!0!==o.noZoom){switch(e.preventDefault(),e.deltaMode){case 2:b.y-=.025*e.deltaY;break;case 1:b.y-=.01*e.deltaY;break;default:b.y-=25e-5*e.deltaY}o.dispatchEvent(d),o.dispatchEvent(m)}}function A(e){if(!1!==o.enabled){switch(e.preventDefault(),e.touches.length){case 1:a=3,g.copy(L(e.touches[0].pageX,e.touches[0].pageY)),f.copy(g);break;default:a=4;const t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;u=c=Math.sqrt(t*t+n*n),_.copy(E((e.touches[0].pageX+e.touches[1].pageX)/2,(e.touches[0].pageY+e.touches[1].pageY)/2)),w.copy(_)}o.dispatchEvent(d)}}function M(e){if(!1!==o.enabled)switch(e.preventDefault(),e.touches.length){case 1:f.copy(g),g.copy(L(e.touches[0].pageX,e.touches[0].pageY));break;default:const t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;u=Math.sqrt(t*t+n*n),w.copy(E((e.touches[0].pageX+e.touches[1].pageX)/2,(e.touches[0].pageY+e.touches[1].pageY)/2))}}function P(e){if(!1!==o.enabled){switch(e.touches.length){case 0:a=-1;break;case 1:a=3,g.copy(L(e.touches[0].pageX,e.touches[0].pageY)),f.copy(g)}o.dispatchEvent(m)}}function D(e){!1!==o.enabled&&e.preventDefault()}this.rotateCamera=function(){const e=new t.Vector3,n=new t.Quaternion,r=new t.Vector3,i=new t.Vector3,a=new t.Vector3,s=new t.Vector3;return function(){s.set(g.x-f.x,g.y-f.y,0);let t=s.length();t?(l.copy(o.object.position).sub(o.target),r.copy(l).normalize(),i.copy(o.object.up).normalize(),a.crossVectors(i,r).normalize(),i.setLength(g.y-f.y),a.setLength(g.x-f.x),s.copy(i.add(a)),e.crossVectors(s,l).normalize(),t*=o.rotateSpeed,n.setFromAxisAngle(e,t),l.applyQuaternion(n),o.object.up.applyQuaternion(n),y.copy(e),h=t):!o.staticMoving&&h&&(h*=Math.sqrt(1-o.dynamicDampingFactor),l.copy(o.object.position).sub(o.target),n.setFromAxisAngle(y,h),l.applyQuaternion(n),o.object.up.applyQuaternion(n)),f.copy(g)}}(),this.zoomCamera=function(){let e;4===a?(e=c/u,c=u,o.object.isPerspectiveCamera?l.multiplyScalar(e):o.object.isOrthographicCamera?(o.object.zoom*=e,o.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(e=1+(v.y-b.y)*o.zoomSpeed,1!==e&&e>0&&(o.object.isPerspectiveCamera?l.multiplyScalar(e):o.object.isOrthographicCamera?(o.object.zoom/=e,o.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),o.staticMoving?b.copy(v):b.y+=(v.y-b.y)*this.dynamicDampingFactor)},this.panCamera=function(){const e=new t.Vector2,n=new t.Vector3,r=new t.Vector3;return function(){if(e.copy(w).sub(_),e.lengthSq()){if(o.object.isOrthographicCamera){const t=(o.object.top-o.object.bottom)/o.object.zoom/o.domElement.clientWidth;e.x*=(o.object.right-o.object.left)/o.object.zoom/o.domElement.clientWidth,e.y*=t}e.multiplyScalar(l.length()*o.panSpeed),r.copy(l).cross(o.object.up).setLength(e.x),r.add(n.copy(o.object.up).setLength(e.y)),o.object.position.add(r),o.target.add(r),o.staticMoving?_.copy(w):_.add(e.subVectors(w,_).multiplyScalar(o.dynamicDampingFactor))}}}(),this.checkDistances=function(){o.noZoom&&o.noPan||(l.lengthSq()>o.maxDistance*o.maxDistance&&(o.object.position.addVectors(o.target,l.setLength(o.maxDistance)),b.copy(v)),l.lengthSq()<o.minDistance*o.minDistance&&(o.object.position.addVectors(o.target,l.setLength(o.minDistance)),b.copy(v)))},this.update=function(){l.subVectors(o.object.position,o.target),o.noRotate||o.rotateCamera(),o.noZoom||o.zoomCamera(),o.noPan||o.panCamera(),o.object.position.addVectors(o.target,l),o.object.isPerspectiveCamera?(o.checkDistances(),o.object.lookAt(o.target),r.distanceToSquared(o.object.position)>1e-6&&(o.dispatchEvent(p),r.copy(o.object.position))):o.object.isOrthographicCamera?(o.object.lookAt(o.target),(r.distanceToSquared(o.object.position)>1e-6||i!==o.object.zoom)&&(o.dispatchEvent(p),r.copy(o.object.position),i=o.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){a=-1,s=-1,o.target.copy(o.target0),o.object.position.copy(o.position0),o.object.up.copy(o.up0),o.object.zoom=o.zoom0,o.object.updateProjectionMatrix(),l.subVectors(o.object.position,o.target),o.object.lookAt(o.target),o.dispatchEvent(p),r.copy(o.object.position),i=o.object.zoom},this.dispose=function(){o.domElement.removeEventListener("contextmenu",D),o.domElement.removeEventListener("pointerdown",x),o.domElement.removeEventListener("wheel",T),o.domElement.removeEventListener("touchstart",A),o.domElement.removeEventListener("touchend",P),o.domElement.removeEventListener("touchmove",M),o.domElement.ownerDocument.removeEventListener("pointermove",j),o.domElement.ownerDocument.removeEventListener("pointerup",k),window.removeEventListener("keydown",O),window.removeEventListener("keyup",C)},this.domElement.addEventListener("contextmenu",D),this.domElement.addEventListener("pointerdown",x),this.domElement.addEventListener("wheel",T,{passive:!1}),this.domElement.addEventListener("touchstart",A,{passive:!1}),this.domElement.addEventListener("touchend",P),this.domElement.addEventListener("touchmove",M,{passive:!1}),this.domElement.ownerDocument.addEventListener("pointermove",j),this.domElement.ownerDocument.addEventListener("pointerup",k),window.addEventListener("keydown",O),window.addEventListener("keyup",C),this.handleResize(),this.update()}}function g(e){return console.clear(),"\n\n   ______________________________    . \\  | / .\n  /                            / \\     \\ \\ / /\n |                            | ==========  - -\n  \\____________________________\\_/     / / \\ \\\n  ______________________________      \\  | / | \\\n /                            / \\     \\ \\ / /.   .\n|                            | ==========  - -\n \\____________________________\\_/     / / \\ \\    /\n   ______________________________   / |\\  | /  .\n  /                            / \\     \\ \\ / /\n |                            | ==========  -  - -\n  \\____________________________\\_/     / / \\ \\\n                                     .  / | \\  .\n\n  Are you trying to wreak havoc!?!\n\n  "+e+"\n\n  Idiot.\n\n  "}var y=function(){function e(e,n){var o=this;void 0===n&&(n=!1),this._containerId=e,this._isWorldFlippable=n,this._scene=new t.Scene,this._canvas=document.createElement("canvas"),this._clock=new t.Clock(!1),this._initialViewingVector=new t.Vector3(10,10,10),this._isSceneReady=!1,this._isRendering=!1,this._isInit=!1,this._fps=60,this._camera=new t.PerspectiveCamera(60,2,.1,13500),this._sceneEntities=[],this.updateCamera=function(){},this.preInitHook=function(){},this.postInitHook=function(){},this.destroyHook=function(){},this.destroy=function(){window.removeEventListener("resize",o.updateCameraAspect),o._stopRendering(),o.destroyHook()},this._render=function(){console.log(">>> render"),o._isRendering&&(o._fps?setTimeout((function(){o._requestAnimationFrameId=requestAnimationFrame(o._render),o._update()}),1e3/o._fps):(o._requestAnimationFrameId=requestAnimationFrame(o._render),o._update()))},this._startRendering=function(){o._isRendering=!0,o._render()},this._stopRendering=function(){console.log("STOP!!!"),o._isRendering=!1}}var n=e.prototype;return n.init=function(){var e=r(s.mark((function e(){var n,o,i=this;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isInit){e.next=2;break}return e.abrupt("return");case 2:if(this._isInit=!0,this.preInitHook(),n=document.getElementById(this._containerId)){e.next=7;break}throw new Error("No container found with id: "+this._containerId);case 7:if(this._canvas.style.width="100%",this._canvas.style.height="100%",n.append(this._canvas),this.updateCameraAspect=this.updateCameraAspect.bind(this),window.addEventListener("resize",this.updateCameraAspect),o=window.devicePixelRatio?window.devicePixelRatio:1,this._renderer=new t.WebGLRenderer({canvas:this._canvas,antialias:!0,alpha:!0}),this._renderer.setPixelRatio(o),this._renderer.sortObjects=!1,this._renderer.shadowMap.enabled=!0,this._renderer.shadowMap.type=t.PCFSoftShadowMap,this._renderer.outputEncoding=t.GammaEncoding,this._camera.position.copy(this._initialViewingVector),this._camera.up=new t.Vector3(0,0,1),this._camera.lookAt(0,0,0),this._orbitControls=this._isWorldFlippable?new f(this._camera,this._renderer.domElement):new l(this._camera,this._renderer.domElement),!(this._orbitControls instanceof l)){e.next=28;break}this._orbitControls.enableDamping=!0,this._orbitControls.dampingFactor=.25,e.next=36;break;case 28:if(!(this._orbitControls instanceof f)){e.next=35;break}this._orbitControls.rotateSpeed=10,this._orbitControls.zoomSpeed=1.2,this._orbitControls.panSpeed=.8,this._orbitControls.keys=["65","83","68"],e.next=36;break;case 35:throw Error("Poor Logic");case 36:if(this._sceneEntities.length){e.next=38;break}throw new Error(g("You have no scene entities!"));case 38:return e.next=40,Promise.all(this._sceneEntities.map(function(){var e=r(s.mark((function e(t){var n;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.init();case 2:if((n=e.sent)&&n.children.length){e.next=5;break}throw new Error(g('\n            -----------------------------------------------------------------------------\n            The scene entity "'+t.constructor.name+'" has empty sceneEntityGroup\n            after initialization!!!\n            -----------------------------------------------------------------------------\n            '));case 5:return i._scene.add(n),e.abrupt("return");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 40:this.setHelpersVisibility(!1),this.updateCameraAspect(),this._clock.start(),this._isRendering=!0,this._startRendering(),this.postInitHook();case 46:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.addSceneEntities=function(e){var t=this;e.forEach((function(e){return t._sceneEntities.push(e)}))},n.setHelpersVisibility=function(e){this._scene.traverse((function(t){return t.userData.isHelper&&(t.visible=e)}))},n.updateCameraAspect=function(){console.log(this._canvas),this._canvas.style.width="100%",this._canvas.style.height="100%";var e=this._canvas.offsetWidth||1,t=this._canvas.offsetHeight||1;this._camera.aspect=e/t,this._camera.updateProjectionMatrix(),this._renderer.setSize(e,t)},n._update=function(){var e,t=this._clock?this._clock.getElapsedTime():0;if(this._sceneEntities.forEach((function(e){return e.update(t)})),this.updateCamera(t),null==(e=this._orbitControls)||e.update(),!this._camera||!this._renderer)throw new Error("Poor Logic");this._requestAnimationFrameId&&this._renderer.render(this._scene,this._camera)},e}();const b=/^[og]\s*(.+)?/,v=/^mtllib /,_=/^usemtl /,w=/^usemap /,E=new t.Vector3,L=new t.Vector3,x=new t.Vector3,j=new t.Vector3,k=new t.Vector3;function O(){const e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);const n=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(e,t){const n=this._finalize(!1);n&&(n.inherited||n.groupCount<=0)&&this.materials.splice(n.index,1);const o={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==n?n.smooth:this.smooth,groupStart:void 0!==n?n.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){const t={index:"number"==typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(o),o},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){const t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(let e=this.materials.length-1;e>=0;e--)this.materials[e].groupCount<=0&&this.materials.splice(e,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},n&&n.name&&"function"==typeof n.clone){const e=n.clone(0);e.inherited=!0,this.object.materials.push(e)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseNormalIndex:function(e,t){const n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseUVIndex:function(e,t){const n=parseInt(e,10);return 2*(n>=0?n-1:n+t/2)},addVertex:function(e,t,n){const o=this.vertices,r=this.object.geometry.vertices;r.push(o[e+0],o[e+1],o[e+2]),r.push(o[t+0],o[t+1],o[t+2]),r.push(o[n+0],o[n+1],o[n+2])},addVertexPoint:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,n){const o=this.normals,r=this.object.geometry.normals;r.push(o[e+0],o[e+1],o[e+2]),r.push(o[t+0],o[t+1],o[t+2]),r.push(o[n+0],o[n+1],o[n+2])},addFaceNormal:function(e,t,n){const o=this.vertices,r=this.object.geometry.normals;E.fromArray(o,e),L.fromArray(o,t),x.fromArray(o,n),k.subVectors(x,L),j.subVectors(E,L),k.cross(j),k.normalize(),r.push(k.x,k.y,k.z),r.push(k.x,k.y,k.z),r.push(k.x,k.y,k.z)},addColor:function(e,t,n){const o=this.colors,r=this.object.geometry.colors;void 0!==o[e]&&r.push(o[e+0],o[e+1],o[e+2]),void 0!==o[t]&&r.push(o[t+0],o[t+1],o[t+2]),void 0!==o[n]&&r.push(o[n+0],o[n+1],o[n+2])},addUV:function(e,t,n){const o=this.uvs,r=this.object.geometry.uvs;r.push(o[e+0],o[e+1]),r.push(o[t+0],o[t+1]),r.push(o[n+0],o[n+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,n,o,r,i,a,s,c){const u=this.vertices.length;let h=this.parseVertexIndex(e,u),l=this.parseVertexIndex(t,u),p=this.parseVertexIndex(n,u);if(this.addVertex(h,l,p),this.addColor(h,l,p),void 0!==a&&""!==a){const e=this.normals.length;h=this.parseNormalIndex(a,e),l=this.parseNormalIndex(s,e),p=this.parseNormalIndex(c,e),this.addNormal(h,l,p)}else this.addFaceNormal(h,l,p);if(void 0!==o&&""!==o){const e=this.uvs.length;h=this.parseUVIndex(o,e),l=this.parseUVIndex(r,e),p=this.parseUVIndex(i,e),this.addUV(h,l,p),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let n=0,o=e.length;n<o;n++){const o=this.parseVertexIndex(e[n],t);this.addVertexPoint(o),this.addColor(o)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const n=this.vertices.length,o=this.uvs.length;for(let t=0,o=e.length;t<o;t++)this.addVertexLine(this.parseVertexIndex(e[t],n));for(let e=0,n=t.length;e<n;e++)this.addUVLine(this.parseUVIndex(t[e],o))}};return e.startObject("",!1),e}class C extends t.Loader{constructor(e){super(e),this.materials=null}load(e,n,o,r){const i=this,a=new t.FileLoader(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(t){try{n(i.parse(t))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),o,r)}setMaterials(e){return this.materials=e,this}parse(e){const n=new O;-1!==e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"\n")),-1!==e.indexOf("\\\n")&&(e=e.replace(/\\\n/g,""));const o=e.split("\n");let r="",i="",a=0,s=[];const c="function"==typeof"".trimLeft;for(let e=0,t=o.length;e<t;e++)if(r=o[e],r=c?r.trimLeft():r.trim(),a=r.length,0!==a&&(i=r.charAt(0),"#"!==i))if("v"===i){const e=r.split(/\s+/);switch(e[0]){case"v":n.vertices.push(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])),e.length>=7?n.colors.push(parseFloat(e[4]),parseFloat(e[5]),parseFloat(e[6])):n.colors.push(void 0,void 0,void 0);break;case"vn":n.normals.push(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]));break;case"vt":n.uvs.push(parseFloat(e[1]),parseFloat(e[2]))}}else if("f"===i){const e=r.substr(1).trim().split(/\s+/),t=[];for(let n=0,o=e.length;n<o;n++){const o=e[n];if(o.length>0){const e=o.split("/");t.push(e)}}const o=t[0];for(let e=1,r=t.length-1;e<r;e++){const r=t[e],i=t[e+1];n.addFace(o[0],r[0],i[0],o[1],r[1],i[1],o[2],r[2],i[2])}}else if("l"===i){const e=r.substring(1).trim().split(" ");let t=[];const o=[];if(-1===r.indexOf("/"))t=e;else for(let n=0,r=e.length;n<r;n++){const r=e[n].split("/");""!==r[0]&&t.push(r[0]),""!==r[1]&&o.push(r[1])}n.addLineGeometry(t,o)}else if("p"===i){const e=r.substr(1).trim().split(" ");n.addPointGeometry(e)}else if(null!==(s=b.exec(r))){const e=(" "+s[0].substr(1).trim()).substr(1);n.startObject(e)}else if(_.test(r))n.object.startMaterial(r.substring(7).trim(),n.materialLibraries);else if(v.test(r))n.materialLibraries.push(r.substring(7).trim());else if(w.test(r))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===i){if(s=r.split(" "),s.length>1){const e=s[1].trim().toLowerCase();n.object.smooth="0"!==e&&"off"!==e}else n.object.smooth=!0;const e=n.object.currentMaterial();e&&(e.smooth=n.object.smooth)}else{if("\0"===r)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+r+'"')}n.finalize();const u=new t.Group;if(u.materialLibraries=[].concat(n.materialLibraries),1==!(1===n.objects.length&&0===n.objects[0].geometry.vertices.length))for(let e=0,o=n.objects.length;e<o;e++){const o=n.objects[e],r=o.geometry,i=o.materials,a="Line"===r.type,s="Points"===r.type;let c=!1;if(0===r.vertices.length)continue;const h=new t.BufferGeometry;h.setAttribute("position",new t.Float32BufferAttribute(r.vertices,3)),r.normals.length>0&&h.setAttribute("normal",new t.Float32BufferAttribute(r.normals,3)),r.colors.length>0&&(c=!0,h.setAttribute("color",new t.Float32BufferAttribute(r.colors,3))),!0===r.hasUVIndices&&h.setAttribute("uv",new t.Float32BufferAttribute(r.uvs,2));const l=[];for(let e=0,o=i.length;e<o;e++){const o=i[e],r=o.name+"_"+o.smooth+"_"+c;let u=n.materials[r];if(null!==this.materials)if(u=this.materials.create(o.name),!a||!u||u instanceof t.LineBasicMaterial){if(s&&u&&!(u instanceof t.PointsMaterial)){const e=new t.PointsMaterial({size:10,sizeAttenuation:!1});t.Material.prototype.copy.call(e,u),e.color.copy(u.color),e.map=u.map,u=e}}else{const e=new t.LineBasicMaterial;t.Material.prototype.copy.call(e,u),e.color.copy(u.color),u=e}void 0===u&&(u=a?new t.LineBasicMaterial:s?new t.PointsMaterial({size:1,sizeAttenuation:!1}):new t.MeshPhongMaterial,u.name=o.name,u.flatShading=!o.smooth,u.vertexColors=c,n.materials[r]=u),l.push(u)}let p;if(l.length>1){for(let e=0,t=i.length;e<t;e++){const t=i[e];h.addGroup(t.groupStart,t.groupCount,e)}p=a?new t.LineSegments(h,l):s?new t.Points(h,l):new t.Mesh(h,l)}else p=a?new t.LineSegments(h,l[0]):s?new t.Points(h,l[0]):new t.Mesh(h,l[0]);p.name=o.name,u.add(p)}else if(n.vertices.length>0){const e=new t.PointsMaterial({size:1,sizeAttenuation:!1}),o=new t.BufferGeometry;o.setAttribute("position",new t.Float32BufferAttribute(n.vertices,3)),n.colors.length>0&&void 0!==n.colors[0]&&(o.setAttribute("color",new t.Float32BufferAttribute(n.colors,3)),e.vertexColors=!0);const r=new t.Points(o,e);u.add(r)}return u}}class T extends t.Loader{constructor(e){super(e)}load(e,n,o,r){const i=this,a=""===this.path?t.LoaderUtils.extractUrlBase(e):this.path,s=new t.FileLoader(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(t){try{n(i.parse(t,a))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),o,r)}setMaterialOptions(e){return this.materialOptions=e,this}parse(e,t){const n=e.split("\n");let o={};const r=/\s+/,i={};for(let e=0;e<n.length;e++){let t=n[e];if(t=t.trim(),0===t.length||"#"===t.charAt(0))continue;const a=t.indexOf(" ");let s=a>=0?t.substring(0,a):t;s=s.toLowerCase();let c=a>=0?t.substring(a+1):"";if(c=c.trim(),"newmtl"===s)o={name:c},i[c]=o;else if("ka"===s||"kd"===s||"ks"===s||"ke"===s){const e=c.split(r,3);o[s]=[parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2])]}else o[s]=c}const a=new A(this.resourcePath||t,this.materialOptions);return a.setCrossOrigin(this.crossOrigin),a.setManager(this.manager),a.setMaterials(i),a}}class A{constructor(e="",n={}){this.baseUrl=e,this.options=n,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=void 0!==this.options.side?this.options.side:t.FrontSide,this.wrap=void 0!==this.options.wrap?this.options.wrap:t.RepeatWrapping}setCrossOrigin(e){return this.crossOrigin=e,this}setManager(e){this.manager=e}setMaterials(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(e){if(!this.options)return e;const t={};for(const n in e){const o=e[n],r={};t[n]=r;for(const e in o){let t=!0,n=o[e];const i=e.toLowerCase();switch(i){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(n=[n[0]/255,n[1]/255,n[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===n[0]&&0===n[1]&&0===n[2]&&(t=!1)}t&&(r[i]=n)}}return t}preload(){for(const e in this.materialsInfo)this.create(e)}getIndex(e){return this.nameLookup[e]}getAsArray(){let e=0;for(const t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray}create(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]}createMaterial_(e){const n=this,o=this.materialsInfo[e],r={name:e,side:this.side};function i(e,t){if(r[e])return;const o=n.getTextureParams(t,r),i=n.loadTexture((a=n.baseUrl,"string"!=typeof(s=o.url)||""===s?"":/^https?:\/\//i.test(s)?s:a+s));var a,s;i.repeat.copy(o.scale),i.offset.copy(o.offset),i.wrapS=n.wrap,i.wrapT=n.wrap,r[e]=i}for(const e in o){const n=o[e];let a;if(""!==n)switch(e.toLowerCase()){case"kd":r.color=(new t.Color).fromArray(n);break;case"ks":r.specular=(new t.Color).fromArray(n);break;case"ke":r.emissive=(new t.Color).fromArray(n);break;case"map_kd":i("map",n);break;case"map_ks":i("specularMap",n);break;case"map_ke":i("emissiveMap",n);break;case"norm":i("normalMap",n);break;case"map_bump":case"bump":i("bumpMap",n);break;case"map_d":i("alphaMap",n),r.transparent=!0;break;case"ns":r.shininess=parseFloat(n);break;case"d":a=parseFloat(n),a<1&&(r.opacity=a,r.transparent=!0);break;case"tr":a=parseFloat(n),this.options&&this.options.invertTrProperty&&(a=1-a),a>0&&(r.opacity=1-a,r.transparent=!0)}}return this.materials[e]=new t.MeshPhongMaterial(r),this.materials[e]}getTextureParams(e,n){const o={scale:new t.Vector2(1,1),offset:new t.Vector2(0,0)},r=e.split(/\s+/);let i;return i=r.indexOf("-bm"),i>=0&&(n.bumpScale=parseFloat(r[i+1]),r.splice(i,2)),i=r.indexOf("-s"),i>=0&&(o.scale.set(parseFloat(r[i+1]),parseFloat(r[i+2])),r.splice(i,4)),i=r.indexOf("-o"),i>=0&&(o.offset.set(parseFloat(r[i+1]),parseFloat(r[i+2])),r.splice(i,4)),o.url=r.join(" ").trim(),o}loadTexture(e,n,o,r,i){const a=void 0!==this.manager?this.manager:t.DefaultLoadingManager;let s=a.getHandler(e);null===s&&(s=new t.TextureLoader(a)),s.setCrossOrigin&&s.setCrossOrigin(this.crossOrigin);const c=s.load(e,o,r,i);return void 0!==n&&(c.mapping=n),c}}class M extends t.CompressedTextureLoader{constructor(e){super(e)}parse(e,n){const o={mipmaps:[],width:0,height:0,format:null,mipmapCount:1};function r(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function i(e,t,n,o){const r=n*o*4,i=new Uint8Array(e,t,r),a=new Uint8Array(r);let s=0,c=0;for(let e=0;e<o;e++)for(let e=0;e<n;e++){const e=i[c];c++;const t=i[c];c++;const n=i[c];c++;const o=i[c];c++,a[s]=n,s++,a[s]=t,s++,a[s]=e,s++,a[s]=o,s++}return a}const a=r("DXT1"),s=r("DXT3"),c=r("DXT5"),u=r("ETC1"),h=new Int32Array(e,0,31);if(542327876!==h[0])return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),o;if(4&!h[20])return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),o;let l;const p=h[21];let d=!1;switch(p){case a:l=8,o.format=t.RGB_S3TC_DXT1_Format;break;case s:l=16,o.format=t.RGBA_S3TC_DXT3_Format;break;case c:l=16,o.format=t.RGBA_S3TC_DXT5_Format;break;case u:l=8,o.format=t.RGB_ETC1_Format;break;default:if(!(32===h[22]&&16711680&h[23]&&65280&h[24]&&255&h[25]&&4278190080&h[26]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",(m=p,String.fromCharCode(255&m,m>>8&255,m>>16&255,m>>24&255))),o;d=!0,l=64,o.format=t.RGBAFormat}var m;o.mipmapCount=1,131072&h[2]&&!1!==n&&(o.mipmapCount=Math.max(1,h[7]));const f=h[28];if(o.isCubemap=!!(512&f),o.isCubemap&&(!(1024&f)||!(2048&f)||!(4096&f)||!(8192&f)||!(16384&f)||!(32768&f)))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),o;o.width=h[4],o.height=h[3];let g=h[1]+4;const y=o.isCubemap?6:1;for(let t=0;t<y;t++){let t=o.width,n=o.height;for(let r=0;r<o.mipmapCount;r++){let r,a;d?(r=i(e,g,t,n),a=r.length):(a=Math.max(4,t)/4*Math.max(4,n)/4*l,r=new Uint8Array(e,g,a)),o.mipmaps.push({data:r,width:t,height:n}),g+=a,t=Math.max(t>>1,1),n=Math.max(n>>1,1)}}return o}}var P,D=function(){var e=this;this._sceneEntityGroup=new t.Group,this.getSceneEntityGroup=function(){return e._sceneEntityGroup}},V=function(e){function n(){var t;return(t=e.apply(this,arguments)||this).update=function(e){t._sceneEntityGroup.rotateY(0*e+.001)},t}return a(n,e),n.prototype.init=function(){var e=r(s.mark((function e(){var n=this;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var o,r;o=function(o){n._sceneEntityGroup.add(o),n._sceneEntityGroup.rotateX(Math.PI/2);var r=new t.BoxHelper(o,16776960);r.userData.isHelper=!0,n._sceneEntityGroup.add(r);var i=new t.Mesh(new t.SphereGeometry(1),new t.MeshPhongMaterial({color:"white",opacity:.5}));i.userData.isHelper=!0,n._sceneEntityGroup.add(i),o.traverse((function(e){e.visible=!0;var o=new t.BoxHelper(e,16776960);o.userData.isHelper=!0,n._sceneEntityGroup.add(o)})),e(n._sceneEntityGroup)},(r=new t.LoadingManager).addHandler(/\.dds$/i,new M),new T(r).load("https://threejs.org/examples/models/obj/male02/male02_dds.mtl",(function(e){e.preload(),(new C).setMaterials(e).load("https://threejs.org/examples/models/obj/male02/male02.obj",(function(e){(function(e,n){var o=Math.pow(10,-10);e.traverse((function(e){e instanceof t.Mesh&&(e.geometry.computeBoundingSphere(),e.geometry&&e.geometry.boundingSphere&&e.geometry.boundingSphere.radius>o&&(o=e.geometry.boundingSphere.radius))}));var r=5/o;e.scale.set(r,r,r)})(e),function(e){var n=(new t.Box3).setFromObject(e).getCenter(new t.Vector3).toArray(),o=n[0],r=n[1],i=n[2],a=e.position.clone().toArray();e.position.set(a[0]-o,a[1]-r,a[2]-i)}(e),function(e){e.traverse((function(e){"Mesh"===e.type&&(e.castShadow=!0,e.receiveShadow=!0)}))}(e),o(e)}),(function(e){console.log(e.loaded/e.total*100+"% loaded")}),(function(e){console.log("Loading error occurred:",e.message)}))}))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n}(D),S=function(e){function n(){var t;return(t=e.apply(this,arguments)||this).update=function(e){t._sceneEntityGroup.position.x+=0*e},t}return a(n,e),n.prototype.init=function(){var e=r(s.mark((function e(){var n=this;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var o=new t.AxesHelper(500);o.userData.isHelper=!0,n._sceneEntityGroup.add(o),e(n._sceneEntityGroup)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n}(D),R=function(e){function n(){var t;return(t=e.apply(this,arguments)||this).update=function(e){t._sceneEntityGroup.position.x+=0*e},t}return a(n,e),n.prototype.init=function(){var e=r(s.mark((function e(){var n=this;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var o=new t.AmbientLight(3355443,.3);o.userData.isAmbientLight=!0,n._sceneEntityGroup.add(o),e(n._sceneEntityGroup)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n}(D),I=function(e){function n(t){var n;return(n=e.call(this)||this).sideLength=t,n.update=function(e){n._sceneEntityGroup.position.x+=0*e},n}return a(n,e),n.prototype.init=function(){var e=r(s.mark((function e(){var n=this;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){n._sceneEntityGroup.add(new t.Mesh(new t.BoxGeometry(n.sideLength,n.sideLength,n.sideLength),new t.MeshPhongMaterial)),n._sceneEntityGroup.position.z=-10,e(n._sceneEntityGroup)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n}(D),F=function(e){function n(){var t;return(t=e.apply(this,arguments)||this).update=function(e){t._sceneEntityGroup.position.x+=0*e},t}return a(n,e),n.prototype.init=function(){var e=r(s.mark((function e(){var n=this;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var o=new t.DirectionalLight(16777215,1);o.position.set(10,10,10),o.lookAt(0,0,0),o.castShadow=!0,n._sceneEntityGroup.add(o);var r=new t.DirectionalLightHelper(o,5);r.userData.isHelper=!0,n._sceneEntityGroup.add(o),n._sceneEntityGroup.add(r),e(n._sceneEntityGroup)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n}(D),H=function(e){function n(n){var o;return(o=e.call(this,n)||this).isRotating=!1,o.updateCamera=function(e){var n=1.111,r=10*Math.sin(.1*e*.5)+n,i=10*Math.cos(.1*e*.5*2+Math.PI)+n,a=10*Math.sin(.1*e*.5+.5*Math.PI)+n;o._camera.position.x=r,o._camera.position.y=i,o._camera.position.z=a;var s=new t.Vector3(0,0,-1);s.applyQuaternion(o._camera.quaternion),o._camera.up.copy(s),o._camera.lookAt(0,0,0)},o.toggleRotation=function(){o.isRotating=!o.isRotating,o.isRotating?o._orbitControls.enabled=!1:(o._camera.position.copy(o._initialViewingVector),o._camera.up.copy(new t.Vector3(0,0,1)),o._orbitControls.enabled=!0)},o.addSceneEntities([new V,new S,new R,new I(1),new F]),o.preInitHook=function(){},o.postInitHook=function(){},o._initialViewingVector=new t.Vector3(6,15,9),o.tempInterval=setInterval((function(){console.log(">>> Hmmm")}),1e3),o.destroyHook=function(){console.log("Clearing interval"),clearInterval(o.tempInterval)},o}return a(n,e),n}(y);function N(e){if(void 0===e&&(e="threejs-canvas-container"),!document.getElementById(e))throw new Error("Can't find div of id "+e);(P=new H(e)).init()}function z(){P.destroy()}e.TsdxThreejsTemplate=function(e){var t=i({width:"100%",height:"100%",backgroundColor:"grey"},e),o=t.width,r=t.height,a=t.backgroundColor,s="this-id-will-never-be-duplicated-says-007";return n.useEffect((function(){return N(s),function(){z(),console.log("Widget app removed!!!")}}),[]),n.createElement("div",{id:s,style:{width:o,height:r,backgroundColor:a}})},e.destroy=z,e.init=N,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=tsdxthreejstemplate.umd.production.min.js.map
